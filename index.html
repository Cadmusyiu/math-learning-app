<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>數學填空遊戲</title>
    <style>
        body {
            font-family: Arial, '微軟正黑體', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f0f4f8;
            margin: 0;
        }
        .math-container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }
        .equation {
            font-size: 2em;
            margin-bottom: 20px;
        }
        .number-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }
        .number-button {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 10px;
            font-size: 1.2em;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .number-button:hover {
            background-color: #45a049;
        }
        .feedback {
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: bold;
        }
        .correct { color: green; }
        .incorrect { color: red; }
    </style>
</head>
<body>
    <div class="math-container">
        <div id="equation" class="equation"></div>
        <div id="number-buttons" class="number-buttons"></div>
        <div id="feedback" class="feedback"></div>
    </div>

    <script>
        // 數學問題類型
        const problemTypes = [
            { 
                type: 'addition', 
                generate: () => {
                    const first = Math.floor(Math.random() * 90) + 10; // 10-99
                    const result = Math.floor(Math.random() * 40) + 20; // 結果20-59
                    const second = result - first;
                    return { first, second, result, operator: '+' };
                }
            },
            { 
                type: 'subtraction', 
                generate: () => {
                    const first = Math.floor(Math.random() * 20) + 10; // 10-29
                    const second = Math.floor(Math.random() * 9) + 1; // 1-9
                    const result = first - second;
                    return { first, second, result, operator: '-' };
                }
            },
            { 
                type: 'multiplication', 
                generate: () => {
                    const first = Math.floor(Math.random() * 9) + 1; // 1-9
                    const second = Math.floor(Math.random() * 9) + 1; // 1-9
                    const result = first * second;
                    return { first, second, result, operator: '×' };
                }
            }
        ];

        // 當前問題和分數
        let currentProblem = null;
        let score = 0;
        let currentType = 'addition';

        // 生成新問題
        function generateProblem(type) {
            currentType = type;
            const problemGenerator = problemTypes.find(p => p.type === type);
            currentProblem = problemGenerator.generate();
            
            // 隨機決定哪個數字被隱藏
            const hideFirst = Math.random() > 0.5;
            currentProblem.hideFirst = hideFirst;

            updateEquationDisplay();
            createNumberButtons();
        }

        // 更新方程式顯示
        function updateEquationDisplay() {
            const equationEl = document.getElementById('equation');
            const { first, second, result, operator, hideFirst } = currentProblem;
            
            if (hideFirst) {
                equationEl.innerHTML = `? ${operator} ${second} = ${result}`;
                currentProblem.correctAnswer = first;
            } else {
                equationEl.innerHTML = `${first} ${operator} ? = ${result}`;
                currentProblem.correctAnswer = second;
            }
        }

        // 創建數字按鈕
        function createNumberButtons() {
            const buttonsEl = document.getElementById('number-buttons');
            buttonsEl.innerHTML = '';
            
            for (let i = 1; i <= 9; i++) {
                const button = document.createElement('button');
                button.className = 'number-button';
                button.textContent = i;
                button.onclick = () => checkAnswer(i);
                buttonsEl.appendChild(button);
            }
        }

        // 檢查答案
        function checkAnswer(selectedNumber) {
            const feedbackEl = document.getElementById('feedback');
            
            if (selectedNumber === currentProblem.correctAnswer) {
                feedbackEl.innerHTML = '✅ 答對了！';
                feedbackEl.className = 'feedback correct';
                score++;
                setTimeout(() => {
                    generateProblem(currentType);
                    feedbackEl.innerHTML = '';
                }, 1500);
            } else {
                feedbackEl.innerHTML = '❌ 再試一次';
                feedbackEl.className = 'feedback incorrect';
                setTimeout(() => {
                    feedbackEl.innerHTML = '';
                }, 1500);
            }
        }

        // 創建操作按鈕
        function createOperationButtons() {
            const container = document.querySelector('.math-container');
            const operationDiv = document.createElement('div');
            operationDiv.style.marginBottom = '20px';
            
            ['addition', 'subtraction', 'multiplication'].forEach(type => {
                const button = document.createElement('button');
                button.textContent = type === 'addition' ? '加法' : 
                                     type === 'subtraction' ? '減法' : '乘法';
                button.onclick = () => generateProblem(type);
                button.style.margin = '0 10px';
                button.style.padding = '10px';
                button.style.backgroundColor = '#2196F3';
                button.style.color = 'white';
                button.style.border = 'none';
                button.style.borderRadius = '5px';
                operationDiv.appendChild(button);
            });

            container.insertBefore(operationDiv, container.firstChild);
        }

        // 初始化
        function init() {
            createOperationButtons();
            generateProblem('addition');
        }

        // 頁面載入時初始化
        init();
    </script>
</body>
</html>
