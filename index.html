<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>萱萱老師數學坊</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@17/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: linear-gradient(135deg, #FFE4E1 0%, #FFF0F5 100%);
        }
    </style>
</head>
<body>
    <div id="root" class="container mx-auto p-6"></div>

    <script type="text/babel">
    function MathLearningApp() {
        const [problem, setProblem] = React.useState(null);
        const [selectedNumber, setSelectedNumber] = React.useState(null);
        const [feedback, setFeedback] = React.useState('');
        const [score, setScore] = React.useState(0);
        const [problemType, setProblemType] = React.useState('addition');

        // 生成加法問題 - 未知數填空
        const generateAdditionProblem = () => {
            const firstNumber = Math.floor(Math.random() * 90) + 10; // 10-99的雙位數
            const result = Math.floor(Math.random() * 40) + 20; // 結果範圍20-59
            const secondNumber = result - firstNumber;
            return {
                firstNumber,
                secondNumber,
                result,
                operator: '+',
                correctAnswer: secondNumber
            };
        };

        // 檢查答案
        const checkAnswer = () => {
            if (selectedNumber === problem.correctAnswer) {
                setFeedback('✅ 太棒了！答對了！');
                setScore(prevScore => prevScore + 1);
                setTimeout(() => {
                    generateNewProblem();
                    setSelectedNumber(null);
                    setFeedback('');
                }, 1500);
            } else {
                setFeedback('❌ 再試一次喔！');
                setTimeout(() => setFeedback(''), 1500);
            }
        };

        // 生成新問題
        const generateNewProblem = () => {
            if (problemType === 'addition') {
                setProblem(generateAdditionProblem());
            }
        };

        // 初始化問題
        React.useEffect(() => {
            generateNewProblem();
        }, [problemType]);

        return (
            <div className="max-w-md mx-auto p-6 bg-white bg-opacity-80 rounded-2xl shadow-2xl text-center relative overflow-hidden">
                {/* 標題 */}
                <h1 className="text-3xl font-bold mb-6 text-pink-600 drop-shadow-md">
                    萱萱老師數學坊 🧮
                </h1>
                
                {/* 問題類型選擇 */}
                <div className="mb-6 flex justify-center space-x-3">
                    {['加法', '減法', '乘法'].map((type, index) => (
                        <button 
                            key={type}
                            onClick={() => {
                                setProblemType(['addition', 'subtraction', 'multiplication'][index]);
                                setSelectedNumber(null);
                                setFeedback('');
                            }} 
                            className={`px-4 py-2 rounded-full shadow-md transition-all duration-300 
                                ${(problemType === ['addition', 'subtraction', 'multiplication'][index]) 
                                    ? 'bg-pink-500 text-white scale-105' 
                                    : 'bg-pink-100 text-pink-600 hover:bg-pink-200'}`}
                        >
                            {type}
                        </button>
                    ))}
                </div>

                {/* 問題顯示 */}
                {problem && problemType === 'addition' && (
                    <div className="mb-6 bg-pink-50 p-6 rounded-xl shadow-inner">
                        <div className="text-4xl font-bold mb-6 text-gray-700">
                            {problem.firstNumber} + ? = {problem.result}
                        </div>
                        
                        {/* 反饋訊息 */}
                        {feedback && (
                            <div className={`mb-4 text-2xl font-bold 
                                ${feedback.includes('✅') 
                                    ? 'text-green-600 animate-bounce' 
                                    : 'text-red-600'}`}
                            >
                                {feedback}
                            </div>
                        )}

                        {/* 數字選擇區 */}
                        <div className="grid grid-cols-3 gap-3 mb-4">
                            {[1, 2, 3, 4, 5, 6, 7, 8, 9].map(num => (
                                <button
                                    key={num}
                                    onClick={() => setSelectedNumber(num)}
                                    className={`py-2 text-lg rounded-lg transition-all duration-300 
                                        ${selectedNumber === num 
                                            ? 'bg-pink-500 text-white scale-105' 
                                            : 'bg-pink-200 text-pink-700 hover:bg-pink-300'}`}
                                >
                                    {num}
                                </button>
                            ))}
                        </div>
                        
                        {/* 檢查按鈕 */}
                        <button 
                            onClick={checkAnswer}
                            disabled={!selectedNumber}
                            className={`w-full p-3 rounded-lg text-xl transition-colors duration-300
                                ${selectedNumber 
                                    ? 'bg-pink-500 text-white hover:bg-pink-600' 
                                    : 'bg-gray-300 text-gray-500 cursor-not-allowed'}`}
                        >
                            檢查答案
                        </button>
                    </div>
                )}

                {/* 分數顯示 */}
                <div className="text-xl text-pink-700 font-bold">
                    目前分數：{score} 分
                </div>
            </div>
        );
    }

    ReactDOM.render(<MathLearningApp />, document.getElementById('root'));
    </script>
</body>
</html>
